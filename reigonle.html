<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>reigonle</title>
  <style>#map,body,html{height:100%;width:100%;padding:0;margin:0}.lds-grid,.lds-grid div{margin:auto;width:50%;padding:10px;float:center;text-align:center;display:block;box-sizing:border-box}.lds-grid{display:inline-block;position:relative;width:80px;height:80px}.lds-grid div{position:absolute;width:16px;height:16px;border-radius:50%;background:currentColor;animation:1.2s linear infinite lds-grid}.lds-grid div:first-child{top:8px;left:8px;animation-delay:0s}.lds-grid div:nth-child(2){top:8px;left:32px;animation-delay:-.4s}.lds-grid div:nth-child(3){top:8px;left:56px;animation-delay:-.8s}.lds-grid div:nth-child(4){top:32px;left:8px;animation-delay:-.4s}.lds-grid div:nth-child(5){top:32px;left:32px;animation-delay:-.8s}.lds-grid div:nth-child(6){top:32px;left:56px;animation-delay:-1.2s}.lds-grid div:nth-child(7){top:56px;left:8px;animation-delay:-.8s}.lds-grid div:nth-child(8){top:56px;left:32px;animation-delay:-1.2s}.lds-grid div:nth-child(9){top:56px;left:56px;animation-delay:-1.6s}@keyframes lds-grid{0%,100%{opacity:1}50%{opacity:.5}}</style>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
   integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
   crossorigin=""/>
   <!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
   integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
   crossorigin=""></script>
  <script src="https://chancejs.com/chance.min.js"></script>
  <script>var document;document=document,L.Browser.svg&&L.SVG.include({_updateStyle:function(c){var b=c._path,a=c.options;b&&(a.stroke?(b.setAttribute("stroke",a.color),b.setAttribute("stroke-opacity",a.opacity),b.setAttribute("stroke-width",a.weight),b.setAttribute("stroke-linecap",a.lineCap),b.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?b.setAttribute("stroke-dasharray",a.dashArray):b.removeAttribute("stroke-dasharray"),a.dashOffset?b.setAttribute("stroke-dashoffset",a.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),a.fill?("string"==typeof a.fill&&a.fill.match(/^url\(/)?this.__fillPattern(c):b.setAttribute("fill",a.fillColor||a.color),b.setAttribute("fill-opacity",a.fillOpacity),b.setAttribute("fill-rule",a.fillRule||"evenodd")):b.setAttribute("fill","none"))},__fillPattern:function(g){var i=g._path,d=g.options;this._defs||(this._defs=L.SVG.create("defs"),this._container.appendChild(this._defs));var f=d.fill.substring(4,d.fill.length-1),e=f+(1e17*Math.random()+1e17*Math.random());e+=new Date().getUTCMilliseconds();var a=document.getElementById(e);if(!a){var h=new Image;h.src=f,(a=L.SVG.create("pattern")).setAttribute("id",e),a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("patternUnits","userSpaceOnUse"),a.setAttribute("width","24"),a.setAttribute("height","24");var b=L.SVG.create("rect");b.setAttribute("width",24),b.setAttribute("height",24),b.setAttribute("x",0),b.setAttribute("x",0),b.setAttribute("fill",d.fillColor||d.color),a.appendChild(b),this._defs.appendChild(a);var c=L.SVG.create("image");c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttributeNS("http://www.w3.org/1999/xlink","href",f),c.setAttribute("width","24"),c.setAttribute("height","24"),a.appendChild(c),h.onload=function(){a.setAttribute("width",h.width),a.setAttribute("height",h.height),c.setAttribute("width",h.width),c.setAttribute("height",h.height)}}i.setAttribute("fill","url(#"+e+")")}})</script>
  

</head>

<body>

  <div id="map"><div class="lds-grid" id="load"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
</div>
  <script>var country_geo_jsons,country_info,ISO3,map,country_list,hint,correct,hint_count=0,previous=[],_start=new Date("08/22/2022");const key=["side of the road","mi2 area","region of the world","population"," a member of the UN","capital(s)","bordering countries"],chance=new Chance("reigonal");var world=new L.LatLngBounds([[90,-180],[-90,180]]);async function load_map(a){L.geoJSON(a,{fill:`url(https://raw.githubusercontent.com/hampusborgos/country-flags/main/png250px/${a.properties.ISO_A2.toLowerCase()}.png)`,fillOpacity:1}).bindPopup(function(a){return a.feature.properties.ADMIN}).openPopup().addTo(map)}async function start(){resp=await fetch("https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson"),ir=await fetch("https://raw.githubusercontent.com/mledoze/countries/master/countries.json"),r3=await fetch("https://raw.githubusercontent.com/jdszekeres/jdszekeres.github.io/main/resources/reigonle.codes.json"),country_geo_jsons=await resp.json(),country_info=await ir.json(),ISO3=await r3.json();var a=[];Object.keys(ISO3).forEach(b=>{is_in(b)&&(a[b]=ISO3[b])}),a.ZWE="Zimbabwe",ISO3=a,country_list=chance.shuffle(Object.keys(ISO3)),map=L.map("map",{minZoom:2,maxZoom:3,maxBounds:world,maxBoundsViscosity:1}),L.tileLayer("https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg").addTo(map),map.setView([0,0],2),document.getElementById("load").remove(),previous=JSON.parse(localStorage.correct??"[]"),await load_all(previous),await load_daily()}async function get_data(a){return(jsonk=await (p=await fetch("https://restcountries.com/v3.1/alpha/"+a)).json())[0].hasOwnProperty("borders")||(jsonk[0].borders=[]),jsonk[0].hasOwnProperty("capital")||(jsonk[0].capital=[]),borders=[],jsonk[0].borders.forEach(a=>{borders.push(ISO3[a])}),0===borders.length&&borders.push("no "),[[jsonk[0].car.side,(jsonk[0].area/2.5899881103464).toLocaleString(),jsonk[0].subregion??jsonk[0].region,jsonk[0].population.toLocaleString(),jsonk[0].unMember?"is":"not",jsonk[0].capital.join(", "),borders.join(", ")],a]}async function load_daily(){current=Math.round(Math.abs((date=Date.now())-_start)/864e5),current%=country_list.length+1;var c,b=await get_data(country_list[current]);hint=b[0],correct=country_list[current],country_geo_jsons.features.forEach(a=>{a.properties.ISO_A3==country_list[current]&&(c=a)});var a=L.control({position:"topright"});a.onAdd=function(c){var a=L.DomUtil.create("div","info legend"),b=document.createElement("select");return b.id="country-sel",Object.keys(ISO3).sort((a,b)=>ISO3[a].localeCompare(ISO3[b])).forEach(a=>{(opt=document.createElement("option")).value=a,opt.innerText=ISO3[a],b.appendChild(opt)}),b.setAttribute("onchange","guess()"),a.appendChild(b),(hints=document.createElement("div")).id="hint",a.appendChild(hints),a},a.addTo(map)}function guess(){(code=document.getElementById("country-sel").options[document.getElementById("country-sel").selectedIndex].value)===correct?(alert("correct"),document.getElementById("country-sel").disabled="true",previous.push(correct),localStorage.correct=JSON.stringify(previous),load_all(previous)):show_hint()}function show_hint(){7===hint_count&&alert("wrong, the answer is "+ISO3[correct]),hint_count<=6&&(document.getElementById("hint").innerHTML+=`<br>${hint[hint_count]} ${key[hint_count]}`,hint_count++)}async function load_all(a){country_geo_jsons.features.forEach(b=>{a.includes(b.properties.ISO_A3)&&load_map(b)})}function is_in(b){for(var a=0;a<country_geo_jsons.features.length-1;a++)if(country_geo_jsons.features[a].properties.ISO_A3===b)return!0;return!1}start()</script>
 
</body>

</html>
